<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Stat2</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Jiye Choi</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Stat/ML
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="stat1.html">Bank Customer Behavior Analysis</a>
    </li>
    <li>
      <a href="stat2.html">Regional Birth Rate Disparities in South Korea</a>
    </li>
    <li>
      <a href="stat3.html">Forecasting Jeju Island Tourism Revenue</a>
    </li>
    <li>
      <a href="stat4.html">Fackbook National Geographic Engagement Analysis</a>
    </li>
    <li>
      <a href="stat5.html">Analyzing Monthly Living Expenses</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="files/resume_jiyechoi.pdf">
    <span class="ai ai-cv ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jiyechoi-data/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<style>
  body {
    font-family: Georgia, "Times New Roman", Times, serif;
  }

  h1, h2 {
    color: #333;
  }
</style>
<p><link rel="stylesheet" href="styles.css" type="text/css">
<link rel="stylesheet" href="site_libs/academicons-1.9.1/css/academicons.min.css"/></p>
<p><br><br><br></p>
<div id="regional-birth-rate-disparities-in-south-korea"
class="section level2">
<h2><strong>Regional Birth Rate Disparities in South Korea</strong></h2>
<p><img src="https://img.shields.io/badge/Using-R-blue" alt="Using R">
<img src="https://img.shields.io/badge/Analysis-PCA-orange">
<img src="https://img.shields.io/badge/-MDS-purple" alt="MDS">
<img src="https://img.shields.io/badge/-Clustering-success">
<img src="https://img.shields.io/badge/-Factor%20Analysis-blue" alt="Factor Analysis"></p>
<p><br></p>
<p><br><br><br></p>
<div id="introduction" class="section level3">
<h3>1. Introduction</h3>
<p><br> Birth rates in South Korea have reached historically low levels,
posing significant social and economic challenges. Understanding the
factors that influence regional birth rates is essential for developing
effective policies to address this issue. This study explores the
complex relationships between socio-economic, educational, welfare, and
demographic variables affecting birth rates across different regions.
<br><br><br><br></p>
</div>
<div id="goal" class="section level3">
<h3>2. Goal</h3>
<p>The primary objective of this study is to identify the key drivers of
declining birth rates and uncover regional patterns using advanced
statistical methods. By employing Principal Component Analysis (PCA),
Factor Analysis, Cluster Analysis, and Multidimensional Scaling (MDS),
this research aims to provide actionable insights for policymakers to
design targeted interventions for increasing birth rates.</p>
<p><br><br><br></p>
</div>
<div id="analysis" class="section level3">
<h3>3. Analysis</h3>
<p><br><br> Variable Descriptions : <br><br></p>
<p><strong>Dependent Variable</strong> <br><br></p>
<ul>
<li>Total Fertility Rate :<br> The average number of children a woman is
expected to have during her lifetime. <br> Includes age-specific
fertility rates (e.g., births per 1,000 women aged 15-19).</li>
</ul>
<p><br><br></p>
<p><strong>Independent Variables</strong> <br><br></p>
<p>Family Factors : <br></p>
<ul>
<li>Crude Marriage Rate : Number of marriages per 1,000 population in a
given year.<br></li>
<li>Crude Divorce Rate : Number of divorces per 1,000 population in a
given year. <br><br></li>
</ul>
<p>Social Factors : <br></p>
<ul>
<li>Population of Marriageable Age Women : Population of women aged
30-34.<br></li>
<li>Average Age at First Marriage Female : Average age at first marriage
by region.<br></li>
<li>EQ5D : Health-related quality of life index, where values closer to
1 indicate better quality.<br></li>
<li>Population Growth Rate : {(Population of comparison year -
Population of base year) ÷ Population of base year} × 100. <br><br></li>
</ul>
<p>Educational Factors : <br></p>
<ul>
<li>Number of Kindergartens : Total number of kindergartens in a
region.<br></li>
<li>Number of Elementary Schools : Total number of elementary schools in
a region. <br><br></li>
</ul>
<p>Welfare Factors : <br></p>
<ul>
<li>Number of Childcare Facilities : Number of childcare facilities per
1,000 children aged 0-4.<br></li>
<li>Number of Cultural Facilities : Number of cultural facilities per
100,000 people. <br><br></li>
</ul>
<p>Economic Factors : <br></p>
<ul>
<li>Fiscal Independence : Ratio of local taxes and non-tax revenue to
the total budget. <br></li>
<li>Fiscal Autonomy : Ratio of self-generated revenue to the total
budget.<br></li>
</ul>
<br><br><br><br>
<h4>
1-1. Exploratory Data Analysis
</h4>
<p><br></p>
<ol style="list-style-type: decimal">
<li>Correlation by Domain <br><br><br></li>
</ol>
<p>To understand the relationships between variables, correlation
coefficients were calculated for each domain: social, family, education,
welfare, and economy. <br><br></p>
<pre class="r"><code>birth = read.csv(&#39;birth.csv&#39;)
head(birth)
data = birth[,-1]

#Social Domain
round(cor(birth[, c(&quot;Average_Age_at_First_Marriage_Female&quot;,&quot;Population_of_Marriageable_Age_Women&quot;,&quot;Population_Growth_Rate&quot;,&quot;EQ5D&quot;)]), 4)

#Family Domain
round(cor(birth[, c(&quot;Marriage_Rate&quot;,&quot;Divorce_Rate&quot;)]), 2)

#Education Domain
round(cor(birth[, c(&quot;Number_of_Kindergartens&quot;, &quot;Number_of_Elementary Schools&quot;)]))

#Welfare Domain
round(cor(birth[, c(&quot;Number_of_Cultural_Facilities&quot;, &quot;Number_of_Childcare_Facilities&quot;)]))

#Economy Domain
round(cor(birth[, c(&quot;Fiscal_Independence&quot;, &quot;Fiscal_Autonomy&quot;)]))

#Correlation Matrix
corr_matrix &lt;- round(cor(birth), 2)
print(corr_matrix)</code></pre>
<p><br><br> Below is a summary of key results: <br><br></p>
<ul>
<li>Social Domain <br></li>
</ul>
<p>The highest correlation was observed between Average Age at First
Marriage Female and Population of Marriageable Age Women (correlation:
0.096). However, the correlation between Average Age at First Marriage
Female and EQ5D (Quality of Life Index) was negligible. <br><br></p>
<ul>
<li>Family Domain <br></li>
</ul>
<p>Crude Marriage Rate and Crude Divorce Rate showed a strong positive
correlation (0.96). <br><br></p>
<ul>
<li>Education Domain <br></li>
</ul>
<p>Number of Kindergartens and Number of Elementary Schools were
strongly correlated (0.95). <br><br></p>
<ul>
<li>Welfare Domain <br></li>
</ul>
<p>Number of Cultural Facilities and Number of Childcare Facilities
showed low correlation (-0.24). <br><br></p>
<ul>
<li>Economic Domain <br></li>
</ul>
<p>Fiscal Independence and Fiscal Autonomy had a moderate positive
correlation (0.35). <br><br></p>
<ul>
<li>Correlation Matrix <br></li>
</ul>
<p>Some variables (e.g., Crude Marriage Rate and Population of
Marriageable Age Women) showed moderate correlations, while others
(e.g., Number of Kindergartens and Number of Elementary Schools)
displayed stronger relationships.</p>
<p><br><br><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Scatterplot Matrix</li>
</ol>
<p><br><br></p>
<pre class="r"><code>pairs(test, panel = function (x, y, ...) { 
    points(x, y, ...)
    abline(lm(y ~ x), col = &#39;red&#39;)
}, cex = 1.5, pch = &quot;*&quot;, bg = &quot;blue&quot;,
    diag.panel = panel.hist, cex.labels = 1, font.labels = 1)
    
panel.hist &lt;- function(x, ...) 
{
   usr &lt;- par(&quot;usr&quot;); on.exit(par(usr))
   par(usr = c(usr[1:2], 0, 1.5) )
   h &lt;- hist(x, plot = FALSE)
   breaks &lt;- h$breaks; nB &lt;- length(breaks)
   y &lt;- h$counts; y &lt;- y/max(y)
   rect(breaks[-nB], 0, breaks[-1], y, col = &quot;cyan&quot;, ...)
}</code></pre>
<p><br><br></p>
<!--Scatterplot Matrix-->
<p align="center">
<img src="images/scatter.png.png" style="width:80%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot Matrix] <br>
</p>
<p><br><br></p>
<p>The scatterplot matrix reveals a strong linear relationship between
Total Fertility Rate and Average Age at First Marriage, as well as
between Number of Kindergartens and Number of Elementary Schools. <br>
<br> However, Cultural Facilities show no notable linear relationship
with other variables, suggesting they may not significantly contribute
to explaining fertility rates. <br> <br> Additionally, the scatterplot
matrix highlights the presence of outliers, indicating the need for
further data preprocessing before re-evaluating the correlations and
patterns.</p>
<p><br><br><br><br> 3) Data Preprocessing</p>
<p><br><br></p>
<p>To analyze the dataset effectively, the normality of each variable
was assessed, followed by the identification of noticeable outliers.</p>
<p><br><br></p>
<pre class="r"><code>layout(matrix(1:16, nc = 4)) 
sapply(colnames(data), function(x) {
        qqnorm(data[[x]], main = x, ) 
        qqline(data[[x]])
})</code></pre>
<p><br><br></p>
<!--Nornality(before)-->
<p align="center">
<img src="images/normality1.png" style="width:90%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Normality Check for Variables] <br>
</p>
<p><br><br></p>
<p>The Q-Q plots revealed that most variables, except for Childcare
Facilities, EQ5D, Average Age at First Marriage, Divorce Rate, Marriage
Rate, and Total Fertility Rate, deviated from normality. <br>
Additionally, many variables were found to have outliers.</p>
<p><br><br></p>
<p>To detect potential outliers, chi-square plots were generated for the
dataset.</p>
<p><br><br></p>
<pre class="r"><code>x &lt;- birth
cm &lt;- colMeans(x)
S &lt;- cov(x)
d &lt;- apply(x, 1, function(x) {t(x-cm) %*% solve(S) %*% (x-cm)}) plot(qc &lt;- qchisq((1:nrow(x) - 1/2) / nrow(x), df=7),
    sd &lt;- sort(d),
    xlab = expression(paste(chi[7]^2, &quot;Quantile&quot;)),
    ylab = &quot;Ordered distances&quot;, xlim = range(qc) * c(1, 1.1))
oups &lt;- which(rank(abs(qc - sd), ties = &quot;random&quot;) &gt; nrow(x) - 5) text(qc[oups], sd[oups] - 1.5, names(oups))
abline(a=0, b=1)</code></pre>
<p><br><br></p>
<!--chi-square-->
<p align="center">
<img src="images/chisqure.png.png" style="width:50%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Chi-square Plot] <br>
</p>
<p><br><br></p>
<p>The chi-square plot revealed that the data for Hanam-si
(Gyeonggi-do), Jeju Special Self-Governing Province, Yeongwol-gun
(Gangwon-do), Haenam-gun (Jeollanam-do), and Jongno-gu (Seoul) deviated
significantly from the expected distribution.</p>
<p><br><br><br></p>
<!--normality w/ outliers-->
<p align="center">
<img src="images/normality2.png.png" style="width:85%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Normality Check After Outlier Removal] <br>
</p>
<p><br><br> After removing outliers, Q-Q plots were generated for each
variable to assess normality.</p>
<p><br><br><br><br> 4) Data Visualization</p>
<p><br><br></p>
<p>Scatterplots by Variable Categories <br><br> The full scatterplot
matrix provides an overview of pairwise relationships across all
variables. <br> Below, scatterplots are grouped by categories for
clearer insights.</p>
<p><br><br></p>
<pre class="r"><code>family &lt;- data[, c(&#39;Crude Marriage Rate&#39;, &#39;Crude Divorce Rate&#39;)] 
pairs(family, diag.panel=panel.hist,
   panel=function(x,y){
    data&lt;-data.frame(cbind(x,y))
    par(new=TRUE) 
    den&lt;-bkde2D(data,bandwidth=sapply(data,dpik)) 
    contour(x=den$x1,y=den$x2,
    z=den$fhat,axes=FALSE)
})</code></pre>
<p><br><br></p>
<!--scatterplot_family-->
<p align="center">
<img src="images/scatterfamily.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot for Family Factors] <br>
</p>
<p><br><br></p>
<p>The results indicate that the family factors exhibit a single peak,
making it difficult to distinguish between regions.</p>
<p><br><br></p>
<pre class="r"><code>education&lt;-data[, c(&#39;Number of Kindergartens
&#39;,&#39;Number of Elementary Schools
&#39;)] 
pairs(education, diag.panel=panel.hist,
  panel=function(x,y){
    data&lt;-data.frame(cbind(x,y))
    par(new=TRUE) 
    den&lt;-bkde2D(data,bandwidth=sapply(data,dpik)) 
    contour(x=den$x1,y=den$x2,
    z=den$fhat,axes=FALSE)
})</code></pre>
<p><br><br></p>
<!--scatterplot_edu-->
<p align="center">
<img src="images/scatteredu.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot for Education Factors] <br>
</p>
<p><br><br></p>
<p>The results indicate that the education factors exhibit a single
peak, making it difficult to differentiate between regions.</p>
<p><br><br></p>
<pre class="r"><code>society&lt;- data[, c(&#39;Marriageable Age Women
&#39;,&#39;Average Age at First Marriage&#39;,&#39;EQ5D&#39;,&#39;Population Growth Rate&#39;)] pairs(society, diag.panel=panel.hist,
  panel=function(x,y){
    data&lt;-data.frame(cbind(x,y))
    par(new=TRUE) 
    den&lt;-bkde2D(data,bandwidth=sapply(data,dpik)) 
    contour(x=den$x1,y=den$x2,
    z=den$fhat,axes=FALSE)
})</code></pre>
<p><br><br></p>
<!--scatterplot_society-->
<p align="center">
<img src="images/scattersociety.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot for Social Factors] <br>
</p>
<p><br><br></p>
<p>The results indicate that the bivariate probability density related
to women of marriageable age in the social factors shows two peaks,
while the other variables in the social domain exhibit a single peak,
making it difficult to distinguish between regions.</p>
<p><br><br></p>
<pre class="r"><code>welfare&lt;-data[, c(&#39;Number of Childcare Facilities&#39;,&#39;Number of Cultural Facilities&#39;)] 
pairs(welfare, diag.panel=panel.hist,
  panel=function(x,y){
    data&lt;-data.frame(cbind(x,y))
    par(new=TRUE) 
    den&lt;-bkde2D(data,bandwidth=sapply(data,dpik)) 
    contour(x=den$x1,y=den$x2,
    z=den$fhat,axes=FALSE)
})</code></pre>
<p><br><br></p>
<!--scatterplot_welfare-->
<p align="center">
<img src="images/scatterwelfare.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot for Welfare Factors] <br>
</p>
<p><br><br></p>
<p>The results indicate that the welfare factors exhibit multiple peaks,
allowing regions to be classified into several groups.</p>
<p><br><br></p>
<pre class="r"><code>economy&lt;-data[, c(&#39;Fiscal Autonomy&#39;,&#39;Fiscal Independence&#39;)] 
pairs(economy, diag.panel=panel.hist,
  panel=function(x,y){
    data&lt;-data.frame(cbind(x,y))
    par(new=TRUE) 
    den&lt;-bkde2D(data,bandwidth=sapply(data,dpik)) 
    contour(x=den$x1,y=den$x2,
    z=den$fhat,axes=FALSE)
})</code></pre>
<p><br><br></p>
<!--scatterplot_economy-->
<p align="center">
<img src="images/scattereconomy.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatterplot for Economy Factors] <br>
</p>
<p><br><br></p>
<p>The results indicate that the economic factors exhibit multiple
peaks, enabling regions to be classified into several groups.</p>
<p><br><br><br><br></p>
<h4>
1-2. PCA
</h4>
<p><br><br></p>
<pre class="r"><code>birth = birth[-outcity,] 
round(cor(birth),2)

birth_corr = cor(birth) 
data_pcacor=princomp(covmat=birth_corr) 
summary(data_pcacor, loading=TRUE)

birth_corr = cor(test) 
data_pcacor=princomp(covmat=birth_corr) 
summary(data_pcacor, loading=TRUE)</code></pre>
<p><br><br></p>
<!--PCA-->
<p align="center">
<img src="images/pca.JPG" style="width:80%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Importance of Principal Components] <br>
</p>
<p><br><br></p>
<ul>
<li>Kaiser’s Rule: Principal components with eigenvalues less than 1 are
excluded.<br></li>
<li>Cumulative Proportion: Principal components PC1, PC2, PC3, PC4, and
PC5, which explain 70-80% of the variance, are selected.<br> <br></li>
<li>To determine the number of principal components, the second method
(cumulative proportion) was applied. <br><br> PC1 explains approximately
36% of the total variance, PC2 explains 17%, PC3 explains 11%, PC4
explains 9%, and PC5 explains 7%. <br><br> Together, these five
components account for around 80% of the total variance, making them the
optimal choice for analysis.</li>
</ul>
<p><br><br></p>
<p><strong>Principal Component Naming</strong></p>
<p><br><br></p>
<!--PCA-->
<p align="center">
<img src="images/pcaname.JPG" style="width:80%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Principal Component Loadings by Variables] <br>
</p>
<p><br><br></p>
<p>Based on the results of the principal component analysis, the
components were named as follows: <br><br></p>
<ul>
<li><strong>PC1 (<em>Urban Development Index</em>)</strong>: Named due
to the high loadings of variables such as <em>Population of Marriageable
Age Women</em>, <em>Number of Cultural Facilities</em>, and <em>Fiscal
Independence</em>. <br><br></li>
<li><strong>PC2 (<em>Demographic Factors</em>)</strong>: Includes
variables like <em>Average Age at First Marriage Female</em>, <em>Total
Fertility Rate</em>, and <em>Population Growth Rate</em>. <br><br></li>
<li><strong>PC3 (<em>Households with Children</em>)</strong>: Comprised
of variables such as <em>Number of Childcare Facilities</em>, <em>Number
of Elementary Schools</em>, <em>Crude Marriage Rate</em>, and <em>Crude
Divorce Rate</em>. <br><br></li>
<li><strong>PC4</strong>: Named after <em>EQ5D</em>, as it had the
highest loading.<br><br></li>
<li><strong>PC5</strong>: Named <em>Fiscal Autonomy</em> due to the
dominant influence of this variable.</li>
</ul>
<p><br><br><br><br></p>
<h4>
1-2. MDS
</h4>
<p><br><br></p>
<ol style="list-style-type: decimal">
<li>Data Validation <br><br></li>
</ol>
<ul>
<li>The Euclidean distance matrix was created, and classical MDS was
applied to determine how well the distances could be reconstructed in 12
dimensions.<br></li>
<li>The first 12 eigenvalues were non-zero, confirming that the
Euclidean distance matrix can be accurately represented in 12
dimensions. <br></li>
<li>The maximum difference between the original distance matrix and the
reconstructed matrix was <span class="math inline">\(3.29 \times
10^{-5}\)</span>, indicating minimal error. <br></li>
<li>A comparison with principal component analysis (PCA) showed a
maximum difference of <span class="math inline">\(9.76 \times
10^{-7}\)</span>, confirming high similarity. <br><br><br><br></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Validation of MDS Results <br></li>
</ol>
<ul>
<li>Most eigenvalues obtained from classical MDS were negative.
<br></li>
<li>This suggests that non-metric MDS may be more appropriate for this
dataset. <br><br><br><br></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Non-metric Multidimensional Scaling (Non-metric MDS)
<br><br><br></li>
</ol>
<pre class="r"><code>library(&quot;MASS&quot;)

(data_mds3 = isoMDS(D))
x = data_mds3$points[, 1]
y = data_mds3$points[, 2]
lim = range(c(x, y)) * 1.2
plot(x, y, xlab = &quot;Coordinate 1&quot;, ylab = &quot;Coordinate 2&quot;,
, ylim = c(-50,50),type = &quot;n&quot;)
text(x, y, rownames(test), cex = 0.7,col = c(&quot;blue&quot;,&quot;black&quot;)[data$city])</code></pre>
<p><br><br></p>
<!--Non-metric MDS-->
<p align="center">
<img src="images/mda.png" style="width:70%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Non-metric Multidimensional Scaling] <br>
</p>
<p><br><br></p>
<p>The results of the non-metric multidimensional scaling (Non-metric
MDS) indicate a clear distinction between the Seoul-Incheon region and
other regions.</p>
<p><br><br><br><br></p>
<h4>
1-3. Factor Analysis
</h4>
<p><br><br></p>
<p>Variables with <em>uniqueness values greater than 0.5</em> were
identified. These variables (<em>Number of Childcare Facilities</em>,
<em>Number of Cultural Facilities</em>, <em>Population Growth Rate</em>,
and <em>EQ5D</em>) were excluded from the analysis.</p>
<p><br><br></p>
<pre class="r"><code>sapply(1:4, function(f)
factanal(scale(data) ,factors=f , method=&quot;mle&quot;)$PVAL)

(scores &lt;- factanal(scale(data), factors = 4 method =&quot;mle&quot;,scores = &quot;regression&quot;)$scores)
factanal(scale(data), factors = 3, method =&quot;mle&quot;)

birth_fit&lt;-birth[,-c(1,7,8,13)] 
birthfit_cor&lt;-cor(test_fit) 
sapply(1:4, function(f)
    factanal(birthfit_cor ,factors=f , method=&quot;mle&quot;)$PVAL)

scores&lt;-factanal(scale(test_fit),factors=4,method=&#39;mle&#39;,scores=&#39;regression&#39;)$scores factanal(covmat=testfit_cor,factors=4,method=&#39;mle&#39;,n.obs=221)
</code></pre>
<p><br><br><br></p>
<table>
<colgroup>
<col width="49%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Factor 1</th>
<th>Factor 2</th>
<th>Factor 3</th>
<th>Factor 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Average Age at First Marriage Female</td>
<td>-</td>
<td>-</td>
<td>-0.131</td>
<td><strong>0.799</strong></td>
</tr>
<tr class="even">
<td>Population of Marriageable Age Women</td>
<td><strong>0.810</strong></td>
<td>0.333</td>
<td>-</td>
<td>0.348</td>
</tr>
<tr class="odd">
<td>Crude Marriage Rate</td>
<td>0.191</td>
<td><strong>0.938</strong></td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>Number of Childcare Facilities</td>
<td><strong>0.985</strong></td>
<td>0.148</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Number of Elementary Schools</td>
<td><strong>0.947</strong></td>
<td>0.110</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="even">
<td>Population Growth Rate</td>
<td>-</td>
<td>0.345</td>
<td>0.328</td>
<td>-</td>
</tr>
<tr class="odd">
<td>Crude Divorce Rate</td>
<td>0.195</td>
<td><strong>0.966</strong></td>
<td>-</td>
<td>0.152</td>
</tr>
<tr class="even">
<td>Fiscal Independence</td>
<td>0.454</td>
<td>0.485</td>
<td>0.533</td>
<td>0.402</td>
</tr>
<tr class="odd">
<td>Fiscal Autonomy</td>
<td>-</td>
<td>-</td>
<td><strong>0.800</strong></td>
<td>-0.138</td>
</tr>
</tbody>
</table>
<p><br><br> Based on the absolute factor loadings, the following groups
were identified: <br><br></p>
<ol style="list-style-type: decimal">
<li><strong>Parents of Young Children</strong> : This group includes
variables such as <em>Population of Marriageable Age Women</em>,
<em>Number of Kindergartens</em>, and <em>Number of Elementary
Schools</em>. <br><br></li>
<li><strong>Marital Status</strong> : This group consists of <em>Crude
Marriage Rate</em> and <em>Crude Divorce Rate</em>. <br><br></li>
<li><strong>Urban Fiscal Capacity</strong> : This group is defined by
<em>Fiscal Independence</em> and <em>Fiscal Autonomy</em>. <br><br></li>
<li><strong>Age at First Marriage for Women</strong> : This group is
represented by the variable <em>Average Age at First Marriage
Female</em>, which showed a high loading.</li>
</ol>
<p><br><br><br><br></p>
<h4>
1-4. Cluster Analysis
</h4>
<p><br><br></p>
<ol style="list-style-type: decimal">
<li><strong>Agglomerative Hierarchical Clustering</strong></li>
</ol>
<p><br><br></p>
<pre class="r"><code>birth = birth[, -1]
X &lt;- scale(birth[, names(birth)])
dj &lt;- dist(x)

plot(cc &lt;- hclust(dj, method = &quot;single&quot;), main = &quot;single&quot;)
plot(cc &lt;- hclust(dj, method = &quot;complete&quot;), main = &quot;complete&quot;)
plot(cc &lt;- hclust(dj, method = &quot;average&quot;), main = &quot;average&quot;)
</code></pre>
<p><br><br></p>
<!--single linkage-->
<p align="center">
<p><img src="images/single.PNG" style="width:70%; border:0px solid; margin-right: 20px" align="center">
<br><br></p>
<!--complete linkage-->
<p align="center">
<p><img src="images/complete.PNG" style="width:70%; border:0px solid; margin-right: 20px" align="center">
<br><br></p>
<!--average linkage-->
<p align="center">
<p><img src="images/average.PNG" style="width:70%; border:0px solid; margin-right: 20px" align="center">
<br><br></p>
<p><br><br> Agglomerative Hierarchical Clustering was applied using
three methods:<br> Single Linkage, Complete Linkage, and Average
Linkage, to observe how the data is hierarchically classified. <br><br>
The results showed that the Complete Linkage Method divided the data
into two major clusters. <br><br> To understand the criteria for these
clusters, the data will be analyzed by region.</p>
<p><br><br><br></p>
<pre class="r"><code>pr &lt;- prcomp(dj)$x[, 1:2]

plot(pr, pch=(1:2)[cutree(cs, k=2)], col = c(&quot;red&quot;, &quot;black&quot;)[test$city], xlim = range(pr) * c(0.9, 1.5))


legend(&quot;topright&quot;, col = c(&quot;red&quot;, &quot;red&quot;, &quot;black&quot;, &quot;black&quot;), legend = c(&quot;1/no&quot;, &quot;2/no&quot;, &quot;1/yes&quot;, &quot;2/yes&quot;), pch = c(1:2, 1:2), title=&quot;Cluster/city&quot;, bty=&quot;n&quot;)
</code></pre>
<p><br><br></p>
<!--cluster_plot-->
<p align="center">
<img src="images/cluster_factor.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Cluster Distribution by Region (PC1 vs. PC2)] <br>
</p>
<p><br><br></p>
<p>The results show the data projected onto the first two principal
component spaces. <br><br> The shape of the points represents the two
clusters (1 and 2), while the colors indicate the values of the city
variable (metropolitan and provincial areas vs. non-metropolitan areas).
<br> The division along the first principal component is influenced by
the fact that it represents “Urban Development.” <br><br> However, this
distinction is not perfectly clear. <br><br></p>
<ul>
<li>city = yes: Seoul, Busan, Daegu, Incheon, Gwangju, Daejeon, Ulsan,
and Gyeonggi Province <br></li>
<li>city = no: All other regions.</li>
</ul>
<p><br><br><br><br></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>K-Means Clustering</strong></li>
</ol>
<p><br><br></p>
<pre class="r"><code>wssplot &lt;- function(data, nc=15, seed=1234){ 
 wss &lt;- (nrow(data)-1)*sum(apply(data, 2, var)) 
 for (i in 2:nc){
    set.seed(seed)
    wss[i] &lt;- sum(kmeans(data, centers=i)$withinss)}
    
 plot(1:nc, wss, type=&quot;b&quot;, xlab=&quot;Number of Clusters&quot;, ylab=&quot;Within groups sum of squares&quot;)}
 
wssplot(training.data)
</code></pre>
<p><br><br></p>
<!--kmean-->
<p align="center">
<img src="images/kmean.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. K-Means Clustering] <br>
</p>
<p><br><br></p>
<p>To perform K-Means Clustering, the number of groups must be
specified. The “elbow” method is used by plotting the within-cluster sum
of squares (WCSS) to determine the optimal number of clusters. In the
graph, the “elbow” appears between 2 and 4 clusters. Therefore, K-Means
Clustering will be conducted with 2 clusters.</p>
<p><br><br></p>
<pre class="r"><code>round( sapply(birth, var), digits=1)

rge &lt;- sapply(birth, function(x) diff(range(x))) 
birth_s &lt;- sweep(birth, 2, rge, FUN = &quot;/&quot;) 
round( sapply(birth_s, var), digits=5) 
kmeans(birth_s, centers = 2)$centers * rge

birth_pca &lt;- prcomp(birth_s)
plot(birth_pca$x[, 1:2], pch = kmeans(birth_s, centers = 2)$cluster)
</code></pre>
<p><br><br></p>
<!--birthplot-->
<p align="center">
<img src="images/birthplot.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Scatter Plot of PC1 vs. PC2] <br>
</p>
<p><br><br></p>
<p>The plot above illustrates the two-group solution in the first two
principal component spaces derived from the correlation matrix. Similar
to the results of the Agglomerative Hierarchical Clustering, the two
groups are well separated along the first principal component score,
representing “Urban Development.”</p>
<p><br><br><br><br></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Partitioning around medoids(PAM)</strong></li>
</ol>
<p><br><br></p>
<p>Partitioning Around Medoids (PAM) is an alternative to K-Means
Clustering, designed to address its sensitivity to outliers. Unlike
K-Means, which represents clusters using centroids (mean vectors), PAM
uses medoids (actual data points) to represent clusters. This allows PAM
to work with different distance metrics, making it suitable for both
continuous variables and mixed data types. Using this method, the data
will be re-clustered.</p>
<p><br><br></p>
<pre class="r"><code>install.packages(&quot;NbClust&quot;)
library(NbClust)
nc &lt;- NbClust(training.data, min.nc=2, max.nc=15, method=&quot;kmeans&quot;) par(mfrow=c(1,1))
barplot(table(nc$Best.n[1,]),
 xlab=&quot;Numer of Clusters&quot;, ylab=&quot;Number of Criteria&quot;, 
 main=&quot;Number of Clusters Chosen&quot;)
</code></pre>
<p><br><br></p>
<!--PAM-->
<p align="center">
<img src="images/pam.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Optimal Number of Clusters Determined by PAM] <br>
</p>
<p><br><br></p>
<p>To determine the optimal number of clusters more accurately, the
NbClust package was used instead of relying solely on the elbow
method.</p>
<p><br><br> The results suggest that 3 clusters are the most appropriate
solution.</p>
<p><br><br></p>
<pre class="r"><code>install.packages(&quot;NbClust&quot;) 
install.packages(&quot;caret&quot;)

#Standardization
data2 = data[, -14] 
names(data2)
data3 &lt;- scale(data2) 
summary(data3)

#Model Building
fit.km=kmeans(data3, 3, nstart=25) 
fit.km$cluster
fit.km$size
fit.km$centers

#Cluster Validation
fit$cluster &lt;-as.factor(fit.km$cluster)

#Principal Component
dj &lt;- dist(data3)
pr &lt;- prcomp(dj)$x[, 1:2]

#Cluster
library(ggplot2)
set.seed(1234)
fit.pam &lt;- pam(data[-1], k=3, stand=TRUE)
fit.pam$medoids
clusplot(fit.pam, main=&quot;Bivariate Cluster Plot&quot;)
fit &lt;-pam(data3,k=3)
data3$clustering &lt;- factor(fit$clustering)
ggplot(data=data3, aes(x=V1,y=V2,color=clustering, shape=clustering))+
    geom_point() + ggtitle(&quot;Clustering of Bivariate Normal Data&quot;)
</code></pre>
<p><br><br></p>
<!--Bivariate Cluster Plot-->
<p align="center">
<img src="images/pam_result.png.png" style="width:60%; border:0px solid; margin-right: 20px" align="center">
<br><br>
</p>
<p align="center" style="font-size: 14px; font-weight: bold;">
[Fig. Bivariate Cluster Plot] <br>
</p>
<p><br><br></p>
<ul>
<li>This plot visualizes the clusters based on the first two principal
components, which explain 56.77% of the variability. <br></li>
<li>The three clusters are well-separated, with Cluster 1 consisting of
X regions, Cluster 2 of Y regions, and Cluster 3 of Z
regions.<br><br></li>
</ul>
<p>The PAM results, visualized in the first two principal component
spaces, reveal three distinct clusters. <br><br></p>
<p>As shown in the figure, two clusters are primarily separated by the
first principal component (“Urban Development”), while the remaining
cluster is divided based on the second principal component (“Demographic
Factors”). <br><br></p>
<p>The interpretation of the ○ and + groups is consistent with the
results from Agglomerative Hierarchical Clustering. The △ group,
however, can be interpreted as regions with low “Demographic Factors” at
the city and district levels.</p>
<p><br><br><br><br></p>
</div>
<div id="code" class="section level3">
<h3>4. Code</h3>
<p>Please click <a
href="https://github.com/jiyechoi-data/BirthRate-Analysis/blob/main/scripts/BirthRate-Code">HERE</a>
for the code.</p>
<p><br><br><br><br></p>
</div>
<div id="conclusion" class="section level3">
<h3>5. Conclusion</h3>
<p><br><br> This project analyzed key factors influencing birth rates at
the city and district levels using PCA, MDS, factor analysis, and
clustering. <br><br></p>
<ul>
<li><strong>Key Factors:</strong> <br> Birth rates are influenced by
urban development (fiscal independence), demographic factors (population
growth), households with children (childcare facilities), quality of
life (EQ5D), and fiscal autonomy.</li>
</ul>
<p><br></p>
<ul>
<li><strong>Regional Grouping:</strong> <br> Clustering revealed two
major groups: metropolitan/provincial areas (high fiscal independence
and cultural infrastructure) and non-metropolitan areas.</li>
</ul>
<p><br></p>
<ul>
<li><strong>Policy Implications:</strong> <br> Focus on increasing the
population of marriageable-age women. Enhance fiscal resources for local
governments to implement targeted family policies.</li>
</ul>
<p><br></p>
</div>
</div>


<br><br>
<footer>
  <p class="copyright text-muted" align="center">Copyright &copy; 2024 Jiye Choi</p>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
